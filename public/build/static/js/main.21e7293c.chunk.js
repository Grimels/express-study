(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{214:function(e,t,n){e.exports=n(387)},219:function(e,t,n){},221:function(e,t,n){},227:function(e,t,n){},327:function(e,t,n){},382:function(e,t,n){},384:function(e,t,n){},387:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(24),c=n.n(o),l=(n(219),n(16)),i=n(17),u=n(19),s=n(18),p=n(20),m=(n(221),n(389)),d=n(23),h=n(30),f=n(149),E=n(32),b=n(25),O={items:[],currentPage:1,haveMore:!0,limit:2},y={error:null},v=function(e){return{type:"MAKE_ERROR",payload:{error:e}}},C=function(){return{type:"CLEAR_ERROR"}},j=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"MAKE_ERROR":return Object(b.a)({},e,{error:t.payload.error});case"CLEAR_ERROR":return Object(b.a)({},e,{error:null});default:return e}};function g(e){if(!e.ok)throw Error(e.statusText);return e}var k,w=function(e){return{type:"FETCH_PRODUCTS_SUCCESS",payload:{products:e}}},R=function(e,t){return{type:"GRAB_PRODUCT_AMOUNT",payload:{id:e,amount:t}}},_=function(e){return{type:"ADD_PRODUCT",payload:{product:e}}},A=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:O,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_PRODUCTS_SUCCESS":return Object(b.a)({},e,{loading:!1,items:[].concat(Object(E.a)(e.items),Object(E.a)(t.payload.products.filter(function(t){return e.items.every(function(e){return String(e.id)!==String(t.id)})}))),currentPage:e.currentPage+1,haveMore:e.limit===t.payload.products.length});case"GRAB_PRODUCT_AMOUNT":return Object(b.a)({},e,{items:e.items.map(function(e){if(e.id===t.payload.id){var n=e.amount-t.payload.amount;return Object(b.a)({},e,{amount:n>=0?n:0})}return e})});case"ADD_PRODUCT_AMOUNT":return Object(b.a)({},e,{items:e.items.map(function(e){if(e.id===t.payload.id){var n=e.amount+t.payload.amount;return Object(b.a)({},e,{amount:n>=0?n:0})}return e})});case"ADD_PRODUCT":var n=e.items.every(function(e){return String(t.payload.product.id)!==String(e.id)});return Object(b.a)({},e,{items:n?[].concat(Object(E.a)(e.items),[t.payload.product]):Object(E.a)(e.items)});default:return e}},S=function(e){return{type:"ADD_TO_CART",payload:{product:e}}},P=function(e){return{type:"DELETE_FROM_CART",payload:{product:e}}},T=[],D=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,t=arguments.length>1?arguments[1]:void 0,n=t.type,a=t.payload;switch(n){case"ADD_TO_CART":var r=e.filter(function(e){return e.id===t.payload.product.id})[0]||null,o=t.payload.product;return r?e.map(function(e){return e.id===t.payload.product.id?Object(b.a)({},e,{amount:Number(e.amount)+Number(o.amount),price:Number(e.price)+Number(o.price)}):e}):[].concat(Object(E.a)(e),[a.product]);case"DELETE_FROM_CART":return e.filter(function(e){return e!==a.product});default:return e}},N=Object(h.c)({products:A,error:j,cart:D}),M=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||h.d,U=n(68),B=n.n(U),x=(n(227),n(388)),F=n(39),L=n.n(F),I=n(67),H=n.n(I),K=n(27),W=n(150),z=n.n(W),G=Object(K.withStyles)(function(e){return{badge:{top:1,right:-15,border:"2px solid ".concat("light"===e.palette.type?e.palette.grey[200]:e.palette.grey[900])}}})(function(e){var t=e;return r.a.createElement("div",{className:"cart-widget"},r.a.createElement(L.a,{color:"link","aria-label":"Cart"},r.a.createElement(H.a,{badgeContent:e.cartItemsCount,color:"secondary",classes:{badge:t.badge}},r.a.createElement(z.a,null))))}),J=n(51),X=n.n(J),V=Object(d.b)(function(e){return{cartItemsCount:e.cart.length,totalCost:X.a.sumBy(e.cart,function(e){return e.price*e.amount})}})(G),Y=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(B.a,{position:"relative"},r.a.createElement("div",{className:"nav"},r.a.createElement(x.a,{to:"/"},r.a.createElement("h2",null,"MyStore")),r.a.createElement(x.a,{to:"/cart",exact:!0},r.a.createElement(V,null))))}}]),t}(r.a.Component),$=Object(d.b)(function(e,t){return{error:e.error.error}},function(e){return{clearError:function(){return e({type:"CLEAR_ERROR"})}}}),q=n(50),Q=n.n(q),Z=n(69),ee=n.n(Z),te=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={open:!0},n.handleClick=function(){n.setState({open:!0})},n.handleClose=function(e,t){"clickaway"!==t&&(n.setState({open:!1}),n.props.clearError())},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.classes;return r.a.createElement("div",null,r.a.createElement(ee.a,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:this.state.open,autoHideDuration:6e3,onClose:this.handleClose,ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},this.props.message),action:[r.a.createElement(Q.a,{key:"undo",color:"secondary",size:"small",onClick:this.props.goBack},"BACK"),r.a.createElement(L.a,{key:"close","aria-label":"Close",color:"inherit",className:e.close,onClick:this.handleClose},r.a.createElement("i",null,"\xd7"))]}))}}]),t}(r.a.Component),ne=Object(K.withStyles)(function(e){return{close:{padding:e.spacing.unit/2}}})(te),ae=$(function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return this.props.error?r.a.createElement(r.a.Fragment,null,r.a.createElement(ne,{message:this.props.error.message,clearError:this.props.clearError})):null}}]),t}(r.a.Component)),re=n(390),oe=n(391),ce=n(5),le=(n(327),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={price:0,amount:1},n.addToCart=function(){n.props.addToCart(Object(b.a)({},n.props.product,{amount:n.state.amount||1})),n.close()},n.close=function(){n.setState({price:0,amount:1}),n.props.handleClose()},n.onChangeAmount=function(e){var t=e.target.value,a=Number(t);0===a?n.setState({amount:""}):a<=0?n.setState(function(){return{price:n.props.product.price,amount:1}}):a<=n.props.product.amount?n.setState(function(e){return{price:a*n.props.product.price,amount:a}}):n.setState(function(e){return{price:n.props.product.amount*n.props.product.price,amount:n.props.product.amount}})},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({price:e.product.price})}},{key:"render",value:function(){return r.a.createElement(ce.d,{open:this.props.open,onClose:this.props.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},r.a.createElement(ce.g,{id:"alert-dialog-title"},"How many ".concat(this.props.product.name," you want?")),r.a.createElement(ce.f,null,r.a.createElement(ce.o,{type:"number",label:"Amount (max ".concat(this.props.product.amount,")"),value:this.state.amount,onChange:this.onChangeAmount}),r.a.createElement(ce.p,{variant:"p"},"Price: ",r.a.createElement("span",null,this.state.price))),r.a.createElement(ce.e,null,r.a.createElement(ce.a,{onClick:this.close,color:"primary"},"Cancel"),r.a.createElement(ce.a,{id:"add-to-cart",onClick:this.addToCart,color:"primary",autoFocus:!0,disabled:!this.props.open},"Add To Cart")))}}]),t}(a.Component)),ie=Object(d.b)(null,function(e){return{addToCart:function(t){e(S(t)),e(R(t.id,t.amount))}}})(le),ue=function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1,selectedProduct:{}},n.handleOpen=function(e){n.setState({open:!0,selectedProduct:e})},n.handleClose=function(){n.setState({open:!1,selectedProduct:{}})},n.load=function(){n.props.fetchProducts(n.props.page,n.props.limit)},n.addMore=function(){n.load()},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){1===this.props.page&&this.load()}},{key:"render",value:function(){var e=this,t=this.props.products.items;if(this.props.error)return r.a.createElement("div",null,r.a.createElement("h2",null,"Oooops... Something went wrong. Server error"),r.a.createElement("p",null,this.props.error.message));var n=t.map(function(t){return r.a.createElement(ce.b,{className:"card",key:t.id},r.a.createElement(ce.c,null,r.a.createElement(x.a,{to:"/products/".concat(t.id)},r.a.createElement("img",{src:t.image,alt:"item"}),r.a.createElement(ce.p,{className:"product-name",variant:"h4"},t.name),r.a.createElement(ce.p,{className:"product-price",variant:"h5"},t.price," ",t.currency)),r.a.createElement(ce.a,{variant:"contained",color:"primary",onClick:function(){return e.handleOpen(t)},disabled:0===t.amount},"In Cart")),r.a.createElement(ie,{open:e.state.open,handleClose:e.handleClose,product:e.state.selectedProduct}))});return r.a.createElement("div",{className:"product-list"},r.a.createElement(ce.a,{className:"btn-show-more",color:"primary",disabled:!this.props.haveMore,variant:"contained",onClick:this.addMore},"ShowMore"),r.a.createElement("div",{className:"card-container"},n))}}]),t}(a.PureComponent),se=Object(d.b)(function(e){return{products:e.products,page:e.products.currentPage,limit:e.products.limit,haveMore:e.products.haveMore,error:e.error.error}},function(e){return{fetchProducts:function(t,n){return e(function(e,t){return function(n){return fetch("http://localhost:8000/api/products?_page=".concat(e,"&&_limit=").concat(t)).then(g).then(function(e){return e.json()}).then(function(e){return n(w(e)),e}).catch(function(e){return n(v(e))})}}(t,n))},addToCart:function(t){e(S(t)),e(R(t.id,t.amount))},deleteFromCart:function(t){return e(P(t))}}})(ue),pe=(n(382),function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).state={open:!1},n.handleOpen=function(){n.setState({open:!0})},n.handleClose=function(){n.setState({open:!1})},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"componentDidMount",value:function(){this.props.product||this.props.fetchProduct(this.props.match.params.id)}},{key:"render",value:function(){var e=this.props.product;return e?r.a.createElement(ce.h,{className:"product"},r.a.createElement("div",{className:"product-content"},r.a.createElement("img",{className:"product-image-full",src:e.image,alt:"item"}),r.a.createElement("div",null,r.a.createElement(ce.p,{variant:"h4"},e.name),r.a.createElement("hr",null),r.a.createElement(ce.p,{variant:"h5"},"Price: ",e.price," ",e.currency),r.a.createElement(ce.p,{variant:"h5"},"Left: ",e.amount))),r.a.createElement(ce.a,{color:"primary",variant:"contained",onClick:this.props.history.goBack},"Back"),r.a.createElement(ce.a,{variant:"contained",color:"primary",onClick:this.handleOpen,disabled:0===e.amount},"In Cart"),r.a.createElement(ie,{open:this.state.open,handleClose:this.handleClose,product:e})):r.a.createElement("div",null,r.a.createElement("h2",null,"Product with this id does not exist!"))}}]),t}(a.PureComponent)),me={fetchProduct:function(e){return function(t){fetch("http://localhost:8000/api/products/".concat(e)).then(function(e){var t=e.status;if(t>=400)throw new Error("Product with this id does not exist ".concat(t));return console.log(e),e.json()}).then(function(e){t(_(e))}).catch(function(e){return t(v(e))})}},clearError:C},de=Object(d.b)(function(e,t){return{product:e.products.items.filter(function(e){return String(e.id)===String(t.match.params.id)})[0]||null,error:e.products.error}},me)(pe),he=(n(384),Object(d.b)(null,function(e){return{deleteFromCart:function(t,n){return e(P(t))},restoreProductAmount:function(t,n){return e(function(e,t){return{type:"ADD_PRODUCT_AMOUNT",payload:{id:e,amount:t}}}(t,n))}}})(function(e){function t(){var e,n;Object(l.a)(this,t);for(var a=arguments.length,r=new Array(a),o=0;o<a;o++)r[o]=arguments[o];return(n=Object(u.a)(this,(e=Object(s.a)(t)).call.apply(e,[this].concat(r)))).remove=function(){n.props.restoreProductAmount(n.props.product.id,n.props.product.amount),n.props.deleteFromCart(n.props.product)},n}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(ce.a,{color:"secondary",variant:"contained",onClick:this.remove},"Remove")}}]),t}(a.Component))),fe=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){var e=this.props.cart.map(function(e,t){return r.a.createElement(ce.n,{key:e.id*Math.random()*Date.now()},r.a.createElement(ce.k,null,t+1),r.a.createElement(ce.k,null,r.a.createElement(x.a,{className:"link-name",to:"/products/".concat(e.id)},e.name)),r.a.createElement(ce.k,null,e.price),r.a.createElement(ce.k,null,e.amount),r.a.createElement(ce.k,null,e.price*e.amount),r.a.createElement(ce.k,null,r.a.createElement(he,{product:e})))});return r.a.createElement("div",{className:"cart"},r.a.createElement(ce.h,null,r.a.createElement(ce.p,{variant:"h2"},"Your Cart"),r.a.createElement(ce.i,null,r.a.createElement(ce.m,null,r.a.createElement(ce.n,null,r.a.createElement(ce.k,null,"\u2116"),r.a.createElement(ce.k,null,"Name"),r.a.createElement(ce.k,null,"Price for one"),r.a.createElement(ce.k,null,"Amount"),r.a.createElement(ce.k,null,"Cost"))),r.a.createElement(ce.j,null,e),r.a.createElement(ce.l,null,r.a.createElement(ce.n,null,r.a.createElement(ce.k,null,"Total"),r.a.createElement(ce.k,null),r.a.createElement(ce.k,null),r.a.createElement(ce.k,null,X.a.sumBy(this.props.cart,function(e){return e.amount})),r.a.createElement(ce.k,null,X.a.sumBy(this.props.cart,function(e){return e.price*e.amount}))))),r.a.createElement(ce.a,{color:"primary",variant:"contained",onClick:this.props.history.goBack},"Back")))}}]),t}(a.Component),Ee=Object(d.b)(function(e){return{cart:e.cart,totalCost:e.cart.totalCost}},function(e){return{addToCart:function(t){return e(S(t))},deleteFromCart:function(t){return e(P(t))}}})(fe),be=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("h2",null,this.props.message))}}]),t}(a.PureComponent),Oe=function(){return r.a.createElement(re.a,null,r.a.createElement(oe.a,{path:"/",component:se,exact:!0}),r.a.createElement(oe.a,{path:"/products/:id",component:de,exact:!0}),r.a.createElement(oe.a,{path:"/cart",component:Ee,exact:!0}),r.a.createElement(oe.a,{component:function(e){return r.a.createElement(be,Object.assign({},e,{message:"Page with this address, does not exist"}))}}))},ye=function(e){return r.a.createElement("div",{className:"main-container"},r.a.createElement("nav",null,r.a.createElement(Y,null)),r.a.createElement("div",{className:"container"},r.a.createElement("main",null,r.a.createElement(Oe,null),r.a.createElement(ae,null))))},ve=Object(h.e)(N,k,M(Object(h.a)(f.a))),Ce=function(e){function t(){return Object(l.a)(this,t),Object(u.a)(this,Object(s.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(i.a)(t,[{key:"render",value:function(){return r.a.createElement(d.a,{store:ve},r.a.createElement(m.a,null,r.a.createElement(ye,null)))}}]),t}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(Ce,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[214,2,1]]]);
//# sourceMappingURL=main.21e7293c.chunk.js.map